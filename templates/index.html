{%extends 'layout.html' %}

{% block body %}
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<div class="main-container" style="text-align: center;">
    <div>
        <h1>Wykres danych z czujnika</h1>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <div id="refresh">
            <div id="chart_div"></div>
        </div>
    </div>
</div>

<script type="text/javascript">
    setInterval(
        function(){
            $('#refresh').load(document.URL +  ' #refresh');
    },15000);
</script>

<script type="text/javascript">
google.charts.load('current', {packages: ['corechart']});
google.charts.setOnLoadCallback(drawBasic);

function drawBasic() {

    var data = new google.visualization.DataTable();
    data.addColumn('number', 'time');
    data.addColumn('number', 'data');

    data.addRows([
        {% for data in dataList %}
            [{{ data[0] }}, {{ data[1] }}],
        {%endfor %}
    ]);

    var options = {
        hAxis: {
            title: 'Czas'
        },
        vAxis: {
            title: 'Wartość z czujnika'
        },
        legend: 'none',
        trendlines: { 0: {
            //type: 'polynomial',
            //degree: 3,
            }
        }
    };

    var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

    chart.draw(data, options);
    refresh();
}
</script>

{% endblock  %}